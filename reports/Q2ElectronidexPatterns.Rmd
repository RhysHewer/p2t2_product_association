---
output:
  html_document:
    code_folding: hide
    number_sections: yes
    theme: cosmo
    toc: yes
    toc_float: yes
---

## Are there any interesting patterns or item relationships within Electronidex's transactions?

```{r message=FALSE} 
#load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(RColorBrewer)
library(tibble)
library(arules)
library(arulesViz)
library(caret)
library(readr)
library(pdftools)
library(stringr)
library(gridExtra)
library(kableExtra)
```

```{r warning=FALSE}
#load csv data
transData <- read.transactions("C:/Users/rhysh/Google Drive/Data Science/Ubiqum/Project 2/Task 4/data/ElectronidexTransactions2017.csv", format = "basket", sep = ",")
prodData <- read.csv("C:/Users/rhysh/Google Drive/Data Science/Ubiqum/Project 2/Task 4/data/ElectronidexTransactions2017.csv", header = FALSE)
```

### Electronidex Transaction Data: Frequency Patterns and Summary
```{r}
#general EDA - high numbers of many-item transactions, mean of 4.83
summary(transData)

#item frequency - nothing interesting here
transFreq <- itemFrequency(transData) %>% as.data.frame %>% rownames_to_column()
colnames(transFreq) <- c("rowNames", "support")
transFreq.filter <- transFreq %>% arrange(desc(support)) %>% head(10) 

kable(transFreq.filter) %>%
        kable_styling(bootstrap_options = "striped", full_width = F, position = "left")
```

Reviewing the summary of the transactions there is nothing that is particularly striking. There are a couple of interesting patterns to note, however:

* There is a reasonably large number of multiple-item transactions
* iMac has the largest frequency (support) by a significant margin.

### Electronidex Transaction Data: Exploring Positive Relationships
```{r message=FALSE, results = "hide"}
#rules creation
basketRulesItem <- apriori(transData, parameter = list(supp = 0.002, conf = 0.3, minlen = 2))

itemFrame <- data.frame(
                lhs = labels(lhs(basketRulesItem)),
                rhs = labels(rhs(basketRulesItem)), 
                basketRulesItem@quality)
```
```{r}
#good metrics
itemFramePos <- itemFrame %>% filter(support > 0.025, confidence > 0.40, lift > 1 )

kable(itemFramePos) %>%
        kable_styling(bootstrap_options = "striped", full_width = F, position = "left")
```

Creating the association rules and examining itemsets with the most positive association rules, an interesting picture does begin to emerge:

* iMac is positively associated with monitors, even though it has a built-in display
* There are multiple cross-platform baskets (Apple v Windows) which is unusual as consumers are usually committed to one platform
* This is a pattern more reflective of a business-to-business organisation than a business-to-consumer one.



