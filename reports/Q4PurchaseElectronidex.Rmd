---
output:
  html_document:
    code_folding: hide
    number_sections: yes
    theme: cosmo
    toc: yes
    toc_float: yes
---

## Should Blackwell acquire Electronidex

```{r message=FALSE} 
#load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(RColorBrewer)
library(tibble)
library(arules)
library(arulesViz)
library(caret)
library(readr)
library(pdftools)
library(stringr)
library(gridExtra)
library(kableExtra)
library(treemap)
```

```{r message=FALSE, results = "hide", warning=FALSE}
#load csv data
transData <- read.transactions("C:/Users/rhysh/Google Drive/Data Science/Ubiqum/Project 2/Task 4/data/ElectronidexTransactions2017.csv", format = "basket", sep = ",")
prodData <- read.csv("C:/Users/rhysh/Google Drive/Data Science/Ubiqum/Project 2/Task 4/data/ElectronidexTransactions2017.csv", header = FALSE)

#Load type data
load("C:/Users/rhysh/Google Drive/Data Science/Ubiqum/Project 2/Task 4/output/typeData.RDS") 

#Load data - Blackwell products info
blackData <- read.csv("C:/Users/rhysh/Google Drive/Data Science/Ubiqum/Project 2/Task 4/data/existingProductAttributes.csv")

##Load Data - Blackwell demographics
blackDemo <- read_csv2("C:/Users/rhysh/Google Drive/Data Science/Ubiqum/Project 2/Task 4/data/Blackwell_Demographic_Data.csv")
colnames(blackDemo)[1] <- "instore"

#Load Data - profit predictions Blackwell
profPred <- read.csv("C:/Users/rhysh/Google Drive/Data Science/Ubiqum/Project 2/Task 4/data/BWNewProfitPredictions.csv")
```

Before making a recommendation as to whether to purchase Electronidex I think it would be beneficial to give an overview of both companies.

## Blackwell Electronics

Blackwell Electronics is a successful consumer electronics retailer with over 30 stores in the southeastern United States and who last year launched an eCommerce website.

### Sales & Profit
```{r}
blackData <- blackData %>% filter(Product.Type != "Extended Warranty") %>% 
        mutate(profit = (Volume * Price * Profit.margin)/10^3, unitProfit = Price * Profit.margin)


blackProfit <- blackData %>% group_by(Product.Type) %>%
        summarise(absProfit = sum(profit), unitProfit = mean(unitProfit), volume = sum(Volume), 
                  meanMargin = mean(Profit.margin), avgPrice = mean(Price))


treemap(blackProfit, index = "Product.Type", vSize = "volume", title = "Blackwell Sales Volume by Product Type")
treemap(blackProfit, index = "Product.Type", vSize = "absProfit", title = "Blackwell Profit by Product Type")
```

We see that in terms of sales volume, Accessories and Game Consoles make up the majority of Blackwell's Products. Looking at the profit, however, we see that it is Games Consoles and Displays that make up a substantial part of Blackwell's profits.

### Transaction Location

```{r}
#Blackwell instore v online 
onlinePurch <- blackDemo %>% group_by(instore) %>%
        summarise(count = n())
onlinePurch <- onlinePurch %>% mutate(percent = (count/sum(onlinePurch$count))*100)
onlinePurch$instore[onlinePurch$instore == 0] <- "Online"
onlinePurch$instore[onlinePurch$instore == 1] <- "In Store"

g6 <- ggplot(onlinePurch, aes(instore, percent)) +
        geom_col(fill = "#31913c") +
        theme_bw() +
        ylab("% Transactions") + 
        xlab("Purchase Location") + 
        ggtitle("Blackwell: Transaction Location") +
        geom_text(aes(label = percent %>% round(0)), vjust = -0.3)
g6
```

We also see that whilst the majority of Blackwell transactions take place online, there is a sizeable proportion that take place in-store.

### Items per Transaction
```{r}
#Blackwell items per purchase
numItems <- blackDemo %>% group_by(items) %>%
        summarise(num_items = n())
numItems <- numItems %>% mutate(percent = (num_items/sum(numItems$num_items))*100)

g7 <- ggplot(numItems, aes(items, percent)) +
        geom_col(fill = "#5c8cdb") +
        theme_bw() +
        ylab("% Transactions") + 
        xlab("Number of Items") + 
        ggtitle("Blackwell: Number of Items distribution")
g7
```

Looking at the distribution of the number of items per purchase we see that most transactions involve 2-7 items with no transactions exceeding 8 items.

### Expected Profitability

```{r}
kable(profPred) %>%
        kable_styling(bootstrap_options = "striped", full_width = F, position = "left")
```

Finally, reviewing the items with the top 5 expected profitability, we see Tablets, PCs, Netbooks and Games Consoles.

## Electronidex

Electronidex is a start-up electronics online retailer.

### Estimated Sales Volume
```{r}
electroProducts <- itemFrequency(typeData) %>% as.data.frame() %>% rownames_to_column()
names(electroProducts) <- c("ProductType", "Support")


treemap(electroProducts, index = "ProductType", vSize = "Support", title = "Electronidex Sales Volume (est.) by Product Type")
```

Using the product-type frequency we can estimate a general picture of the type of products sole by Electronidex and the approximate sales volume.

We see that Desktops, Laptops and Monitors form a large portion of their business.

### Estimated Items per Transaction
```{r}
#Electronidex items per purchase
sizeTrans <- size(transData)
transTable <- table(sizeTrans) %>% as.data.frame()
transTable <- transTable %>% mutate(percent = (Freq/sum(transTable$Freq))*100)

g8 <- ggplot(transTable, aes(sizeTrans, percent)) +
        geom_col(fill = "#519b3b") +
        theme_bw() +
        ylab("% Transactions") + 
        xlab("Number of Items") + 
        ggtitle("Electronidex: Number of Items distribution")
g8
```

As we only have transaction information, not sales figures, we can only make some general conclusions about numbers of items per transaction. Using the unsatisfactory metric of 1 item sold if the item is present within the transaction we can still draw somw general conclusions.

Looking at the distribution of the estimated number of items per purchase we see that whilst almost 80% of the sales conist of between 1-8 items, 20% exceed this. As we do not have the sales figures, I believe that this underestimates the items-per-transaction figure. The presence of a large number of high-item-number transactions reinforces the picture of Electronidex as a business-to-business organisation.

## Organisational Conclusions

Blackwell Electronics is a consumer electronics retailer with online and in-store presence. Blackwell services mostly small-basket transactions and generates profitability through displays and games consoles. Future profitable items are expected to be tablets, PCs, netbooks and games consoles.

Electronidex is an online-only business-to-business startup, potentially a distributor, who service larger item-number baskets. Their top selling product types are desktops, laptops and monitors.

## Blackwell SWOT Analysis

![](C:/Users/rhysh/Google Drive/Data Science/Ubiqum/Project 2/Task 4/output/swot.png)

Blackwells biggest problems stem from being a small retailer squeezed betweeen large retailers and small, niche retailers and having a limited and generic product offering.

To combat this, Blackwell should leverage it's strengths and look to move into newer markets using data analytics and mobile commerce as key tools to do so.

My opinion is that the vision for Blackwell should be one of an organisation focussing on a younger consumer base (13-40), stocking the newest products and using and expanding its analytics capabilities to be more nimble in the marketplace. This would allow us to build on our already profitable products of games consoles and monitors.

Electronidex is a distribution/B2B organisation and acquiring this could give us economies of scale and allow us to expand deeper into the supply chain side of the business. Choosing to go large - in competition with the retail giants - versus to go niche would not be in line with where I think our strategic goals should be. Our analysis has also cast doubt that any synergy would be delivered in respect of mutually-reinforcing product types.

My recommendation is that Blackwell should not aqcuire Electronidex.
