g1 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), absProfit, fill = unitProfit)) +
geom_col() +
scale_fill_gradient(low = "skyblue", high = "blue4") +
theme_bw() +
ylab("Profit ($ thousands)") +
xlab(NULL) +
ggtitle("Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position ="top") +
geom_text(aes(label = absProfit %>% round(0)), vjust = -0.3)
g1
g2 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), volume)) +
geom_col(fill = "#45c16a") +
theme_bw() +
ylab("Sales Volume") +
xlab("Product Type") +
ggtitle("Sales Volume per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = volume %>% round(0)), vjust = -0.3)
g2
grid.arrange(g1, g2)
grid.arrange(ncol = 2, g1, g2)
g1 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), absProfit, fill = unitProfit)) +
geom_col() +
scale_fill_gradient(low = "skyblue", high = "blue4") +
theme_bw() +
ylab("Profit ($ thousands)") +
xlab("Product Type") +
ggtitle("Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position ="top") +
geom_text(aes(label = absProfit %>% round(0)), vjust = -0.3)
g1
g2 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), volume)) +
geom_col(fill = "#45c16a") +
theme_bw() +
ylab("Sales Volume") +
xlab("Product Type") +
ggtitle("Sales Volume per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = volume %>% round(0)), vjust = -0.3)
g2
grid.arrange(ncol = 2, g1, g2)
g1 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), absProfit, fill = unitProfit)) +
geom_col() +
scale_fill_gradient(low = "skyblue", high = "blue4") +
theme_bw() +
ylab("Profit ($ thousands)") +
xlab("Product Type") +
ggtitle("Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.9)) +
geom_text(aes(label = absProfit %>% round(0)), vjust = -0.3)
g1
g2 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), volume)) +
geom_col(fill = "#45c16a") +
theme_bw() +
ylab("Sales Volume") +
xlab("Product Type") +
ggtitle("Sales Volume per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = volume %>% round(0)), vjust = -0.3)
g1 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), absProfit, fill = unitProfit)) +
geom_col() +
scale_fill_gradient(low = "skyblue", high = "blue4") +
theme_bw() +
ylab("Profit ($ thousands)") +
xlab("Product Type") +
ggtitle("Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.8, 0.8)) +
geom_text(aes(label = absProfit %>% round(0)), vjust = -0.3)
g1
g2 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), volume)) +
geom_col(fill = "#45c16a") +
theme_bw() +
ylab("Sales Volume") +
xlab("Product Type") +
ggtitle("Sales Volume per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = volume %>% round(0)), vjust = -0.3)
g2
grid.arrange(ncol = 2, g1, g2)
g1 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), absProfit, fill = unitProfit)) +
geom_col() +
scale_fill_gradient(low = "skyblue", high = "blue4") +
theme_bw() +
ylab("Profit ($ thousands)") +
xlab("Product Type") +
ggtitle("Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.9)) +
geom_text(aes(label = absProfit %>% round(0)), vjust = -0.3)
g1
grid.arrange(ncol = 2, g1, g2)
g1 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), absProfit, fill = unitProfit)) +
geom_col() +
scale_fill_gradient(low = "skyblue", high = "blue4") +
theme_bw() +
ylab("Profit ($ thousands)") +
xlab("Product Type") +
ggtitle("Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.85)) +
geom_text(aes(label = absProfit %>% round(0)), vjust = -0.3)
grid.arrange(ncol = 2, g1, g2)
electroProducts <- itemFrequency(typeData) %>% as.data.frame() %>% rownames_to_column()
names(electroProducts) <- c("ProductType", "Support")
electroProducts <- electroProducts %>% mutate(Occurance = Support * 9835)
g3 <- ggplot(electroProducts, aes(reorder(ProductType, -Support), Support)) +
geom_col(fill = "#ae82bc") +
theme_bw() +
ylab("Frequency") +
xlab("Product Type") +
ggtitle("Frequency per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = Support %>% round(2)), vjust = -0.3)
g3
g3 <- ggplot(electroProducts, aes(reorder(ProductType, -Occurance), Occurance)) +
geom_col(fill = "#ae82bc") +
theme_bw() +
ylab("Frequency") +
xlab("Product Type") +
ggtitle("Frequency per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = Support %>% round(2)), vjust = -0.3)
g3
electroProducts
compProd <- electroProducts %>% filter(ProductType = accessories, monitor, laptop,
desktop, printer, printink, tablet)
compProd <- electroProducts %>% filter(ProductType == accessories, monitor, laptop,
desktop, printer, printink, tablet)
compProd <- electroProducts %>% filter(ProductType == accessories)
compProd <- electroProducts %>% filter(ProductType == "accessories", "monitor", "laptop",
"desktop", "printer", "printink", "tablet")
compProd <- electroProducts %>% filter(ProductType == "accessories" | ProductType == "monitor" | ProductType == "laptop" |
ProductType == "desktop" | ProductType == "printer" | ProductType == "printink" | ProductType == "tablet")
compProd
g3 <- ggplot(electroProducts, aes(reorder(ProductType, -Occurance), Occurance)) +
geom_col(fill = "#ae82bc") +
theme_bw() +
ylab("Frequency") +
xlab("Product Type") +
ggtitle("Sales Volume (est.) per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = Support %>% round(2)), vjust = -0.3)
g3
g3 <- ggplot(electroProducts, aes(reorder(ProductType, -Occurance), Occurance)) +
geom_col(fill = "#ae82bc") +
theme_bw() +
ylab("Sales Volume (month, est.)") +
xlab("Product Type") +
ggtitle("Sales Volume (est.) per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = Support %>% round(2)), vjust = -0.3)
g3
blackProfit <- blackData %>% group_by(Product.Type) %>%
summarise(absProfit = sum(profit), unitProfit = mean(unitProfit), volume = sum(Volume), meanMargin = mean(Profit.margin))
blackProfit
compProd
compProd$profitMargin <- c(0.05, 0.172, 0.107, 0.142, 0.139, 0.317, 0.17)
compProd
blackProfit <- blackData %>% group_by(Product.Type) %>%
summarise(absProfit = sum(profit), unitProfit = mean(unitProfit), volume = sum(Volume), meanMargin = mean(Profit.margin), avgPrice = mean(Price))
blackProfit
compProd$avgPrice <- c(60.1, 550, 754, 1052, 217, 51, 472)
compProd
compProd <- compProd %>% mutate(profit = Occurance * profitMargin * avgPrice)
compProd
g4 <- ggplot(compProd, aes(ProductType, profit)) +
geom_col
g4 <- ggplot(compProd, aes(ProductType, profit)) +
geom_col()
g4
compProd <- compProd %>% mutate(profit = (Occurance * profitMargin * avgPrice)/10^3)
g4 <- ggplot(compProd, aes(ProductType, profit)) +
geom_col()
g4
g4 <- ggplot(compProd, aes(reorder(ProductType, profit), profit) +
g4 <- ggplot(compProd, aes(reorder(ProductType, profit), profit)) +
geom_col()
g4
g4 <- ggplot(compProd, aes(reorder(ProductType, profit), profit)) +
geom_col()
g4
g4 <- ggplot(compProd, aes(reorder(ProductType, -profit), profit)) +
geom_col()
g4
g1
g4 <- ggplot(compProd, aes(reorder(ProductType, -profit), profit)) +
geom_col() +
ylab("Profit ($ thousands)") +
xlab("Product Type") +
ggtitle("Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.85)) +
geom_text(aes(label = absProfit %>% round(0)), vjust = -0.3)
g4
g4 <- ggplot(compProd, aes(reorder(ProductType, -profit), profit)) +
geom_col() +
ylab("Profit ($ thousands)") +
xlab("Product Type") +
ggtitle("Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.85)) +
geom_text(aes(label = profit %>% round(0)), vjust = -0.3)
g4
g4 <- ggplot(compProd, aes(reorder(ProductType, -profit), profit)) +
geom_col() +
theme_bw() +
ylab("Profit ($ thousands)") +
xlab("Product Type") +
ggtitle("Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.85)) +
geom_text(aes(label = profit %>% round(0)), vjust = -0.3)
grid.arrange(ncol = 2, g1, g4)
g4 <- ggplot(compProd, aes(reorder(ProductType, -profit), profit)) +
geom_col() +
theme_bw() +
ylab("Profit ($ thousands per month)") +
xlab("Product Type") +
ggtitle("Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.85)) +
geom_text(aes(label = profit %>% round(0)), vjust = -0.3)
g2 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), volume)) +
geom_col(fill = "#45c16a") +
theme_bw() +
ylab("Sales Volume") +
xlab("Product Type") +
ggtitle("Sales Volume per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = volume %>% round(0)), vjust = -0.3)
grid.arrange(ncol = 2, g1, g4)
g1 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), absProfit, fill = unitProfit)) +
geom_col() +
scale_fill_gradient(low = "skyblue", high = "blue4") +
theme_bw() +
ylab("Profit ($ thousands, timescale unknown)") +
xlab("Product Type") +
ggtitle("Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.85)) +
geom_text(aes(label = absProfit %>% round(0)), vjust = -0.3)
grid.arrange(ncol = 2, g1, g4)
grid.arrange(ncol = 2, g3, g4)
grid.arrange(ncol = 2, g1, g4)
g4 <- ggplot(compProd, aes(reorder(ProductType, -profit), profit)) +
geom_col() +
scale_fill_gradient(low = "skyblue", high = "blue4") +
theme_bw() +
ylab("Profit ($ thousands per month)") +
xlab("Product Type") +
ggtitle("Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.85)) +
geom_text(aes(label = profit %>% round(0)), vjust = -0.3)
g4
g4 <- ggplot(compProd, aes(reorder(ProductType, -profit), profit, fill = "#996210")) +
geom_col() +
theme_bw() +
ylab("Profit ($ thousands per month)") +
xlab("Product Type") +
ggtitle("Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.85)) +
geom_text(aes(label = profit %>% round(0)), vjust = -0.3)
g4
g4 <- ggplot(compProd, aes(reorder(ProductType, -profit), profit)) +
geom_col(colour = "#996210") +
theme_bw() +
ylab("Profit ($ thousands per month)") +
xlab("Product Type") +
ggtitle("Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.85)) +
geom_text(aes(label = profit %>% round(0)), vjust = -0.3)
g4
g4 <- ggplot(compProd, aes(reorder(ProductType, -profit), profit)) +
geom_col(fill = "#996210") +
theme_bw() +
ylab("Profit ($ thousands per month)") +
xlab("Product Type") +
ggtitle("Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.85)) +
geom_text(aes(label = profit %>% round(0)), vjust = -0.3)
g4
g4 <- ggplot(compProd, aes(reorder(ProductType, -profit), profit)) +
geom_col(fill = "#996210") +
theme_bw() +
ylab("Profit ($ thousands per month)") +
xlab("Product Type") +
ggtitle("Electronidex: Profit per shared Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.85)) +
geom_text(aes(label = profit %>% round(0)), vjust = -0.3)
g4
grid.arrange(ncol = 2, g1, g4)
g1 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), absProfit, fill = unitProfit)) +
geom_col() +
scale_fill_gradient(low = "skyblue", high = "blue4") +
theme_bw() +
ylab("Profit ($ thousands, timescale unknown)") +
xlab("Product Type") +
ggtitle("Blackwell: Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.85)) +
geom_text(aes(label = absProfit %>% round(0)), vjust = -0.3)
g2 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), volume)) +
geom_col(fill = "#45c16a") +
theme_bw() +
ylab("Sales Volume") +
xlab("Product Type") +
ggtitle("Blackwell: Sales Volume per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = volume %>% round(0)), vjust = -0.3)
g3 <- ggplot(electroProducts, aes(reorder(ProductType, -Occurance), Occurance)) +
geom_col(fill = "#ae82bc") +
theme_bw() +
ylab("Sales Volume (month, est.)") +
xlab("Product Type") +
ggtitle("Electronidex: Sales Volume (est.) per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = Support %>% round(2)), vjust = -0.3)
grid.arrange(ncol = 2, g1, g2)
grid.arrange(ncol = 2, g3, g4)
grid.arrange(ncol = 2, g1, g4)
grid.arrange(ncol = 2, g3, g4)
#load data
data <- read.transactions("*C:\Users\Rhys\Downloads\basket.csv", format = "basket", sep = ",")
#load data
data <- read.transactions("C:/Users/Rhys/Downloads/basket.csv", format = "basket", sep = ",")
library(dplyr)
library(arules)
library(tidyr)
library(readr)
library(arules)
library(arulesViz)
#load data
data <- read.transactions("C:/Users/Rhys/Downloads/basket.csv", format = "basket", sep = ",")
## EDA
inspect(data)
summary(data)
itemLabels(data)
size(data)
summary(itemFrequency(data))
itemFrequency(data)
basketRules <- apriori(data, parameter = list(supp = 0, conf = 0.0, minlen = 2))
basketRules
inspect(basketRules)
basketRules %>% sort(by = "lift") %>% tail(10) %>% inspect()
class(basketRules)
basketFrame <- data.frame(
lhs = labels(lhs(basketRules)),
rhs = labels(rhs(basketRules)),
basketRules@quality)
basketFrame
fagsPlus <- basketFrame %>% filter(lhs == "{fags}", support > 0.05, confidence > 0.3, lift > 1)
fagsPlus
buyFags <- basketFrame %>% filter(rhs == "{fags}", support > 0.05, confidence > 0.3, lift > 1)
buyFags
itemFrequencyPlot(data)
itemFrequencyPlot(data) %>% head(3)
itemFrequencyPlot(data, topN = 3, cex.names = 0.7, col = brewer.pal(8, 'Dark2'))
library(RColorBrewer)
itemFrequencyPlot(data, topN = 3, cex.names = 0.7, col = brewer.pal(8, 'Dark2'))
itemFrequencyPlot(data, topN = 3, cex.names = 0.7, col = brewer.pal(6, 'Dark2'))
itemFrequencyPlot(data, topN = 3, cex.names = 0.7, col = brewer.pal(1, 'Dark2'))
itemFrequencyPlot(data, topN = 3, cex.names = 0.7, col = brewer.pal('Dark2'))
itemFrequencyPlot(data, topN = 3, cex.names = 0.7, col = brewer.pal(3,'Dark2'))
display.brewer.all()
itemFrequencyPlot(data, topN = 3, cex.names = 0.7, col = brewer.pal(3,'Blues'))
itemFrequencyPlot(data, topN = 3, cex.names = 0.7, col = brewer.pal(3,-'Blues'))
basketFrame
itemFrequency(data)
itemFrequency(data) %>% as.table
itemFrequency(data) %>% as.data.frame
freq <- itemFrequency(data) %>% as.data.frame
View(freq)
#load libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(RColorBrewer)
library(tibble)
library(arules)
library(arulesViz)
library(caret)
library(readr)
library(pdftools)
library(stringr)
library(treemap) # take a look at this as a comparison tool.
library(gridExtra)
freq <- itemFrequency(data) %>% as.data.frame %>% rownames_to_column()
View(freq)
colnames(freq) <- c("rowNames", "support")
itemFrequencyPlot(data, topN = 3, cex.names = 0.7, col = brewer.pal(3,'Blues'))
gtest <- ggplot(freq, aes(rowName, support)) +
geom_col()
gtest
gtest <- ggplot(freq, aes(rowNames, support)) +
geom_col()
gtest
gtest <- ggplot(freq, aes(reorder(rowNames, support), support) +
gtest <- ggplot(freq, aes(reorder(rowNames, support), support)) +
geom_col()
gtest
gtest <- ggplot(freq, aes(reorder(rowNames, support), support)) +
geom_col()
gtest
gtest <- ggplot(freq, aes(reorder(rowNames, -support), support)) +
geom_col()
gtest
gtest <- ggplot(freq, aes(reorder(rowNames, -support), support)) +
geom_col(fill = "#665aa8")
gtest
gtest <- ggplot(freq, aes(reorder(rowNames, -support), support, fill = support)) +
geom_col()
gtest
gtest <- ggplot(freq, aes(reorder(rowNames, -support), support, fill = support)) +
geom_col() +
scale_fill_gradient(low = "skyblue", high = "blue4")
gtest
gtest <- ggplot(freq, aes(reorder(rowNames, -support), support, fill = support)) +
geom_col() +
scale_fill_gradient(low = "skyblue", high = "blue4") +
theme_bw() +
ylab("Support") +
xlab("Product Type") +
ggtitle("Support per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = support %>% round(0)), vjust = -0.3)
gtest
gtest <- ggplot(freq, aes(reorder(rowNames, -support), support, fill = support)) +
geom_col() +
scale_fill_gradient(low = "skyblue", high = "blue4") +
theme_bw() +
ylab("Support") +
xlab("Product Type") +
ggtitle("Support per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = support %>% round(2)), vjust = -0.3)
gtest
itemFrequencyPlot(data, topN = 3, cex.names = 0.7, col = brewer.pal(3,'Blues'))
gtest <- ggplot(freq, aes(reorder(rowNames, -support), support, fill = support)) +
geom_col() +
scale_fill_gradient(low = "skyblue", high = "blue4") +
theme_bw() +
ylab("Support") +
xlab("Product Type") +
ggtitle("Support per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = support %>% round(2)), vjust = -0.3)
gtest
freq.filter <- freq %>% arrange() %>% desc(support)
freq.filter <- freq %>% arrange(desc(support)) %>% head(3)
freq.filter
gtest <- ggplot(freq.filter, aes(reorder(rowNames, -support), support, fill = support)) +
geom_col() +
scale_fill_gradient(low = "skyblue", high = "blue4") +
theme_bw() +
ylab("Support") +
xlab("Product Type") +
ggtitle("Support per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = support %>% round(2)), vjust = -0.3)
gtest
load("output/transData.RDS") # transaction data individual items (sparse matrix)
load("output/prodData.RDS") # transaction data indivifual items (S3 data)
load("output/typeData.RDS") # transaction data product type (sparse matrix)
#Load data - Blackwell products info
blackData <- read.csv("data/existingProductAttributes.csv")
##BLACKWELL DATA
#EDA of blackwell profitability
blackData <- blackData %>% filter(Product.Type != "Extended Warranty") %>%
mutate(profit = (Volume * Price * Profit.margin)/10^3, unitProfit = Price * Profit.margin)
blackProfit <- blackData %>% group_by(Product.Type) %>%
summarise(absProfit = sum(profit), unitProfit = mean(unitProfit), volume = sum(Volume),
meanMargin = mean(Profit.margin), avgPrice = mean(Price))
blackProfit
g1 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), absProfit, fill = unitProfit)) +
geom_col() +
scale_fill_gradient(low = "skyblue", high = "blue4") +
theme_bw() +
ylab("Profit ($ thousands, timescale unknown)") +
xlab("Product Type") +
ggtitle("Blackwell: Profit per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.85)) +
geom_text(aes(label = absProfit %>% round(0)), vjust = -0.3)
g1
g2 <- ggplot(blackProfit, aes(reorder(Product.Type, -absProfit), volume)) +
geom_col(fill = "#45c16a") +
theme_bw() +
ylab("Sales Volume") +
xlab("Product Type") +
ggtitle("Blackwell: Sales Volume per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = volume %>% round(0)), vjust = -0.3)
g2
electroProducts <- itemFrequency(typeData) %>% as.data.frame() %>% rownames_to_column()
names(electroProducts) <- c("ProductType", "Support")
electroProducts <- electroProducts %>% mutate(Occurance = Support * 9835)
electroProducts
g3 <- ggplot(electroProducts, aes(reorder(ProductType, -Occurance), Occurance)) +
geom_col(fill = "#ae82bc") +
theme_bw() +
ylab("Sales Volume (month, est.)") +
xlab("Product Type") +
ggtitle("Electronidex: Sales Volume (est.) per Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0)) +
geom_text(aes(label = Support %>% round(2)), vjust = -0.3)
g3
##comparison of blackwell and electronidex shared product types (not sure how useful this is)
compProd <- electroProducts %>% filter(ProductType == "accessories" | ProductType == "monitor" | ProductType == "laptop" |
ProductType == "desktop" | ProductType == "printer" | ProductType == "printink" | ProductType == "tablet")
compProd$profitMargin <- c(0.05, 0.172, 0.107, 0.142, 0.139, 0.317, 0.17)
compProd$avgPrice <- c(60.1, 550, 754, 1052, 217, 51, 472)
compProd <- compProd %>% mutate(profit = (Occurance * profitMargin * avgPrice)/10^3)
g4 <- ggplot(compProd, aes(reorder(ProductType, -profit), profit)) +
geom_col(fill = "#996210") +
theme_bw() +
ylab("Profit ($ thousands per month)") +
xlab("Product Type") +
ggtitle("Electronidex: Profit per shared Product Type") +
theme(axis.text.x=element_text(angle = -45, hjust = 0), legend.position = c(0.9, 0.85)) +
geom_text(aes(label = profit %>% round(0)), vjust = -0.3)
g4
